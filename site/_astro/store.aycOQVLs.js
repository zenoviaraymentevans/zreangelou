let j=[],F=0;const fe=4;let Xr=e=>{let r=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(n){return t.lc=r.push(n),()=>{for(let i=F+fe;i<j.length;)j[i]===n?j.splice(i,fe):i+=fe;let s=r.indexOf(n);~s&&(r.splice(s,1),--t.lc||t.off())}},notify(n,s){let i=!j.length;for(let a of r)j.push(a,t.value,n,s);if(i){for(F=0;F<j.length;F+=fe)j[F](j[F+1],j[F+2],j[F+3]);j.length=0}},off(){},set(n){let s=t.value;s!==n&&(t.value=n,t.notify(s))},subscribe(n){let s=t.listen(n);return n(t.value),s},value:e};return t};function Yr(e,r){let t=dr(r),n=e;for(let s of t){if(n===void 0)break;n=n[s]}return n}function et(e,r,t){return gr(e??{},dr(r),t)}function gr(e,r,t){let n=r[0],s=Array.isArray(e)?[...e]:{...e};return r.length===1?(t===void 0?Array.isArray(s)?s.splice(n,1):delete s[n]:s[n]=t,s):(tt(s,n,r[1]),s[n]=gr(s[n],r.slice(1),t),s)}const Ve=/(.*)\[(\d+)\]/;function dr(e){return e.split(".").flatMap(r=>hr(r))}function hr(e){if(Ve.test(e)){let[,r,t]=e.match(Ve);return[...hr(r),t]}return[e]}const rt=/^\d+$/;function tt(e,r,t){if(r in e)return;rt.test(t)?e[r]=Array(parseInt(t,10)+1):e[r]={}}function nt(e={}){let r=Xr(e);return r.setKey=(t,n)=>{if(Yr(r.value,t)!==n){let s=r.value;r.value=et(r.value,t,n),r.notify(s,t)}},r}/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function w(e){var r,t;return Ue(e)===!1?!1:(r=e.constructor,r===void 0?!0:(t=r.prototype,!(Ue(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}var mr=Symbol.for("immer-nothing"),Je=Symbol.for("immer-draftable"),x=Symbol.for("immer-state");function S(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Z=Object.getPrototypeOf;function $(e){return!!e&&!!e[x]}function I(e){return e?vr(e)||Array.isArray(e)||!!e[Je]||!!e.constructor?.[Je]||he(e)||me(e):!1}var st=Object.prototype.constructor.toString();function vr(e){if(!e||typeof e!="object")return!1;const r=Z(e);if(r===null)return!0;const t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===st}function ue(e,r){de(e)===0?Reflect.ownKeys(e).forEach(t=>{r(t,e[t],e)}):e.forEach((t,n)=>r(n,t,e))}function de(e){const r=e[x];return r?r.type_:Array.isArray(e)?1:he(e)?2:me(e)?3:0}function Ae(e,r){return de(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function yr(e,r,t){const n=de(e);n===2?e.set(r,t):n===3?e.add(t):e[r]=t}function it(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function he(e){return e instanceof Map}function me(e){return e instanceof Set}function q(e){return e.copy_||e.base_}function je(e,r){if(he(e))return new Map(e);if(me(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const t=vr(e);if(r===!0||r==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(e);delete n[x];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const a=s[i],f=n[a];f.writable===!1&&(f.writable=!0,f.configurable=!0),(f.get||f.set)&&(n[a]={configurable:!0,writable:!0,enumerable:f.enumerable,value:e[a]})}return Object.create(Z(e),n)}else{const n=Z(e);if(n!==null&&t)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function De(e,r=!1){return ve(e)||$(e)||!I(e)||(de(e)>1&&(e.set=e.add=e.clear=e.delete=at),Object.freeze(e),r&&Object.entries(e).forEach(([t,n])=>De(n,!0))),e}function at(){S(2)}function ve(e){return Object.isFrozen(e)}var ot={};function K(e){const r=ot[e];return r||S(0,e),r}var ne;function pr(){return ne}function ft(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Qe(e,r){r&&(K("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function Se(e){ke(e),e.drafts_.forEach(ct),e.drafts_=null}function ke(e){e===ne&&(ne=e.parent_)}function Ze(e){return ne=ft(ne,e)}function ct(e){const r=e[x];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function He(e,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];return e!==void 0&&e!==t?(t[x].modified_&&(Se(r),S(4)),I(e)&&(e=le(r,e),r.parent_||ge(r,e)),r.patches_&&K("Patches").generateReplacementPatches_(t[x].base_,e,r.patches_,r.inversePatches_)):e=le(r,t,[]),Se(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==mr?e:void 0}function le(e,r,t){if(ve(r))return r;const n=r[x];if(!n)return ue(r,(s,i)=>Ge(e,n,r,s,i,t)),r;if(n.scope_!==e)return r;if(!n.modified_)return ge(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,a=!1;n.type_===3&&(i=new Set(s),s.clear(),a=!0),ue(i,(f,c)=>Ge(e,n,s,f,c,t,a)),ge(e,s,!1),t&&e.patches_&&K("Patches").generatePatches_(n,t,e.patches_,e.inversePatches_)}return n.copy_}function Ge(e,r,t,n,s,i,a){if($(s)){const f=i&&r&&r.type_!==3&&!Ae(r.assigned_,n)?i.concat(n):void 0,c=le(e,s,f);if(yr(t,n,c),$(c))e.canAutoFreeze_=!1;else return}else a&&t.add(s);if(I(s)&&!ve(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;le(e,s),(!r||!r.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&ge(e,s)}}function ge(e,r,t=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&De(r,t)}function ut(e,r){const t=Array.isArray(e),n={type_:t?1:0,scope_:r?r.scope_:pr(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=Fe;t&&(s=[n],i=se);const{revoke:a,proxy:f}=Proxy.revocable(s,i);return n.draft_=f,n.revoke_=a,f}var Fe={get(e,r){if(r===x)return e;const t=q(e);if(!Ae(t,r))return lt(e,t,r);const n=t[r];return e.finalized_||!I(n)?n:n===xe(e.base_,r)?(Ee(e),e.copy_[r]=Re(n,e)):n},has(e,r){return r in q(e)},ownKeys(e){return Reflect.ownKeys(q(e))},set(e,r,t){const n=br(q(e),r);if(n?.set)return n.set.call(e.draft_,t),!0;if(!e.modified_){const s=xe(q(e),r),i=s?.[x];if(i&&i.base_===t)return e.copy_[r]=t,e.assigned_[r]=!1,!0;if(it(t,s)&&(t!==void 0||Ae(e.base_,r)))return!0;Ee(e),Ne(e)}return e.copy_[r]===t&&(t!==void 0||r in e.copy_)||Number.isNaN(t)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=t,e.assigned_[r]=!0),!0},deleteProperty(e,r){return xe(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,Ee(e),Ne(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const t=q(e),n=Reflect.getOwnPropertyDescriptor(t,r);return n&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:n.enumerable,value:t[r]}},defineProperty(){S(11)},getPrototypeOf(e){return Z(e.base_)},setPrototypeOf(){S(12)}},se={};ue(Fe,(e,r)=>{se[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});se.deleteProperty=function(e,r){return se.set.call(this,e,r,void 0)};se.set=function(e,r,t){return Fe.set.call(this,e[0],r,t,e[0])};function xe(e,r){const t=e[x];return(t?q(t):e)[r]}function lt(e,r,t){const n=br(r,t);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function br(e,r){if(!(r in e))return;let t=Z(e);for(;t;){const n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;t=Z(t)}}function Ne(e){e.modified_||(e.modified_=!0,e.parent_&&Ne(e.parent_))}function Ee(e){e.copy_||(e.copy_=je(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var gt=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,t,n)=>{if(typeof r=="function"&&typeof t!="function"){const i=t;t=r;const a=this;return function(c=i,...l){return a.produce(c,y=>t.call(this,y,...l))}}typeof t!="function"&&S(6),n!==void 0&&typeof n!="function"&&S(7);let s;if(I(r)){const i=Ze(this),a=Re(r,void 0);let f=!0;try{s=t(a),f=!1}finally{f?Se(i):ke(i)}return Qe(i,n),He(s,i)}else if(!r||typeof r!="object"){if(s=t(r),s===void 0&&(s=r),s===mr&&(s=void 0),this.autoFreeze_&&De(s,!0),n){const i=[],a=[];K("Patches").generateReplacementPatches_(r,s,i,a),n(i,a)}return s}else S(1,r)},this.produceWithPatches=(r,t)=>{if(typeof r=="function")return(a,...f)=>this.produceWithPatches(a,c=>r(c,...f));let n,s;return[this.produce(r,t,(a,f)=>{n=a,s=f}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){I(e)||S(8),$(e)&&(e=dt(e));const r=Ze(this),t=Re(e,void 0);return t[x].isManual_=!0,ke(r),t}finishDraft(e,r){const t=e&&e[x];(!t||!t.isManual_)&&S(9);const{scope_:n}=t;return Qe(n,r),He(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let t;for(t=r.length-1;t>=0;t--){const s=r[t];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}t>-1&&(r=r.slice(t+1));const n=K("Patches").applyPatches_;return $(e)?n(e,r):this.produce(e,s=>n(s,r))}};function Re(e,r){const t=he(e)?K("MapSet").proxyMap_(e,r):me(e)?K("MapSet").proxySet_(e,r):ut(e,r);return(r?r.scope_:pr()).drafts_.push(t),t}function dt(e){return $(e)||S(10,e),wr(e)}function wr(e){if(!I(e)||ve(e))return e;const r=e[x];let t;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=je(e,r.scope_.immer_.useStrictShallowCopy_)}else t=je(e,!0);return ue(t,(n,s)=>{yr(t,n,wr(s))}),r&&(r.finalized_=!1),t}var E=new gt,Te=E.produce;E.produceWithPatches.bind(E);E.setAutoFreeze.bind(E);E.setUseStrictShallowCopy.bind(E);E.applyPatches.bind(E);var Xe=E.createDraft.bind(E),Ye=E.finishDraft.bind(E),o={ancestors(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:t=!1}=r,n=o.levels(e,r);return t?n=n.slice(1):n=n.slice(0,-1),n},common(e,r){for(var t=[],n=0;n<e.length&&n<r.length;n++){var s=e[n],i=r[n];if(s!==i)break;t.push(s)}return t},compare(e,r){for(var t=Math.min(e.length,r.length),n=0;n<t;n++){if(e[n]<r[n])return-1;if(e[n]>r[n])return 1}return 0},endsAfter(e,r){var t=e.length-1,n=e.slice(0,t),s=r.slice(0,t),i=e[t],a=r[t];return o.equals(n,s)&&i>a},endsAt(e,r){var t=e.length,n=e.slice(0,t),s=r.slice(0,t);return o.equals(n,s)},endsBefore(e,r){var t=e.length-1,n=e.slice(0,t),s=r.slice(0,t),i=e[t],a=r[t];return o.equals(n,s)&&i<a},equals(e,r){return e.length===r.length&&e.every((t,n)=>t===r[n])},hasPrevious(e){return e[e.length-1]>0},isAfter(e,r){return o.compare(e,r)===1},isAncestor(e,r){return e.length<r.length&&o.compare(e,r)===0},isBefore(e,r){return o.compare(e,r)===-1},isChild(e,r){return e.length===r.length+1&&o.compare(e,r)===0},isCommon(e,r){return e.length<=r.length&&o.compare(e,r)===0},isDescendant(e,r){return e.length>r.length&&o.compare(e,r)===0},isParent(e,r){return e.length+1===r.length&&o.compare(e,r)===0},isPath(e){return Array.isArray(e)&&(e.length===0||typeof e[0]=="number")},isSibling(e,r){if(e.length!==r.length)return!1;var t=e.slice(0,-1),n=r.slice(0,-1),s=e[e.length-1],i=r[r.length-1];return s!==i&&o.equals(t,n)},levels(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:t=!1}=r,n=[],s=0;s<=e.length;s++)n.push(e.slice(0,s));return t&&n.reverse(),n},next(e){if(e.length===0)throw new Error("Cannot get the next path of a root path [".concat(e,"], because it has no next index."));var r=e[e.length-1];return e.slice(0,-1).concat(r+1)},operationCanTransformPath(e){switch(e.type){case"insert_node":case"remove_node":case"merge_node":case"split_node":case"move_node":return!0;default:return!1}},parent(e){if(e.length===0)throw new Error("Cannot get the parent path of the root path [".concat(e,"]."));return e.slice(0,-1)},previous(e){if(e.length===0)throw new Error("Cannot get the previous path of a root path [".concat(e,"], because it has no previous index."));var r=e[e.length-1];if(r<=0)throw new Error("Cannot get the previous path of a first child path [".concat(e,"] because it would result in a negative index."));return e.slice(0,-1).concat(r-1)},relative(e,r){if(!o.isAncestor(r,e)&&!o.equals(e,r))throw new Error("Cannot get the relative path of [".concat(e,"] inside ancestor [").concat(r,"], because it is not above or equal to the path."));return e.slice(r.length)},transform(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return null;var n=[...e],{affinity:s="forward"}=t;if(e.length===0)return n;switch(r.type){case"insert_node":{var{path:i}=r;(o.equals(i,n)||o.endsBefore(i,n)||o.isAncestor(i,n))&&(n[i.length-1]+=1);break}case"remove_node":{var{path:a}=r;if(o.equals(a,n)||o.isAncestor(a,n))return null;o.endsBefore(a,n)&&(n[a.length-1]-=1);break}case"merge_node":{var{path:f,position:c}=r;o.equals(f,n)||o.endsBefore(f,n)?n[f.length-1]-=1:o.isAncestor(f,n)&&(n[f.length-1]-=1,n[f.length]+=c);break}case"split_node":{var{path:l,position:y}=r;if(o.equals(l,n)){if(s==="forward")n[n.length-1]+=1;else if(s!=="backward")return null}else o.endsBefore(l,n)?n[l.length-1]+=1:o.isAncestor(l,n)&&e[l.length]>=y&&(n[l.length-1]+=1,n[l.length]-=y);break}case"move_node":{var{path:d,newPath:p}=r;if(o.equals(d,p))return n;if(o.isAncestor(d,n)||o.equals(d,n)){var O=p.slice();return o.endsBefore(d,p)&&d.length<p.length&&(O[d.length-1]-=1),O.concat(n.slice(d.length))}else o.isSibling(d,p)&&(o.isAncestor(p,n)||o.equals(p,n))?o.endsBefore(d,n)?n[d.length-1]-=1:n[d.length-1]+=1:o.endsBefore(p,n)||o.equals(p,n)||o.isAncestor(p,n)?(o.endsBefore(d,n)&&(n[d.length-1]-=1),n[p.length-1]+=1):o.endsBefore(d,n)&&(o.equals(p,n)&&(n[p.length-1]+=1),n[d.length-1]-=1);break}}return n}};function ie(e){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ie(e)}function ht(e,r){if(ie(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(ie(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function mt(e){var r=ht(e,"string");return ie(r)==="symbol"?r:String(r)}function H(e,r,t){return r=mt(r),r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function er(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function re(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?er(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):er(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var vt=(e,r,t)=>{switch(t.type){case"insert_node":{var{path:n,node:s}=t,i=u.parent(e,n),a=n[n.length-1];if(a>i.children.length)throw new Error('Cannot apply an "insert_node" operation at path ['.concat(n,"] because the destination is past the end of the node."));if(i.children.splice(a,0,s),r)for(var[f,c]of g.points(r))r[c]=m.transform(f,t);break}case"insert_text":{var{path:l,offset:y,text:d}=t;if(d.length===0)break;var p=u.leaf(e,l),O=p.text.slice(0,y),P=p.text.slice(y);if(p.text=O+d+P,r)for(var[G,X]of g.points(r))r[X]=m.transform(G,t);break}case"merge_node":{var{path:N}=t,D=u.get(e,N),_r=o.previous(N),Y=u.get(e,_r),xr=u.parent(e,N),Er=N[N.length-1];if(b.isText(D)&&b.isText(Y))Y.text+=D.text;else if(!b.isText(D)&&!b.isText(Y))Y.children.push(...D.children);else throw new Error('Cannot apply a "merge_node" operation at path ['.concat(N,"] to nodes of different interfaces: ").concat(k.stringify(D)," ").concat(k.stringify(Y)));if(xr.children.splice(Er,1),r)for(var[Ar,jr]of g.points(r))r[jr]=m.transform(Ar,t);break}case"move_node":{var{path:T,newPath:Ce}=t;if(o.isAncestor(T,Ce))throw new Error("Cannot move a path [".concat(T,"] to new path [").concat(Ce,"] because the destination is inside itself."));var Sr=u.get(e,T),kr=u.parent(e,T),Nr=T[T.length-1];kr.children.splice(Nr,1);var ye=o.transform(T,t),Rr=u.get(e,o.parent(ye)),Dr=ye[ye.length-1];if(Rr.children.splice(Dr,0,Sr),r)for(var[Fr,Tr]of g.points(r))r[Tr]=m.transform(Fr,t);break}case"remove_node":{var{path:C}=t,Cr=C[C.length-1],zr=u.parent(e,C);if(zr.children.splice(Cr,1),r)for(var[ee,Lr]of g.points(r)){var ze=m.transform(ee,t);if(r!=null&&ze!=null)r[Lr]=ze;else{var V=void 0,z=void 0;for(var[Le,pe]of u.texts(e))if(o.compare(pe,C)===-1)V=[Le,pe];else{z=[Le,pe];break}var be=!1;V&&z&&(o.equals(z[1],C)?be=!o.hasPrevious(z[1]):be=o.common(V[1],C).length<o.common(z[1],C).length),V&&!be?(ee.path=V[1],ee.offset=V[0].text.length):z?(ee.path=z[1],ee.offset=0):r=null}}break}case"remove_text":{var{path:Br,offset:Be,text:qe}=t;if(qe.length===0)break;var we=u.leaf(e,Br),qr=we.text.slice(0,Be),Mr=we.text.slice(Be+qe.length);if(we.text=qr+Mr,r)for(var[$r,Ir]of g.points(r))r[Ir]=m.transform($r,t);break}case"set_node":{var{path:Me,properties:Kr,newProperties:Oe}=t;if(Me.length===0)throw new Error("Cannot set properties on the root node!");var Pe=u.get(e,Me);for(var U in Oe){if(U==="children"||U==="text")throw new Error('Cannot set the "'.concat(U,'" property of nodes!'));var $e=Oe[U];$e==null?delete Pe[U]:Pe[U]=$e}for(var Ie in Kr)Oe.hasOwnProperty(Ie)||delete Pe[Ie];break}case"set_selection":{var{newProperties:L}=t;if(L==null)r=L;else{if(r==null){if(!g.isRange(L))throw new Error('Cannot apply an incomplete "set_selection" operation properties '.concat(k.stringify(L)," when there is no current selection."));r=re({},L)}for(var J in L){var Ke=L[J];if(Ke==null){if(J==="anchor"||J==="focus")throw new Error('Cannot remove the "'.concat(J,'" selection property'));delete r[J]}else r[J]=Ke}}break}case"split_node":{var{path:Q,position:oe,properties:We}=t;if(Q.length===0)throw new Error('Cannot apply a "split_node" operation at path ['.concat(Q,"] because the root node cannot be split."));var B=u.get(e,Q),Wr=u.parent(e,Q),Vr=Q[Q.length-1],_e;if(b.isText(B)){var Ur=B.text.slice(0,oe),Jr=B.text.slice(oe);B.text=Ur,_e=re(re({},We),{},{text:Jr})}else{var Qr=B.children.slice(0,oe),Zr=B.children.slice(oe);B.children=Qr,_e=re(re({},We),{},{children:Zr})}if(Wr.children.splice(Vr+1,0,_e),r)for(var[Hr,Gr]of g.points(r))r[Gr]=m.transform(Hr,t);break}}return r},yt={transform(e,r){e.children=Xe(e.children);var t=e.selection&&Xe(e.selection);try{t=vt(e,t,r)}finally{e.children=Ye(e.children),t?e.selection=$(t)?Ye(t):t:e.selection=null}}},pt={insertNodes(e,r,t){e.insertNodes(r,t)},liftNodes(e,r){e.liftNodes(r)},mergeNodes(e,r){e.mergeNodes(r)},moveNodes(e,r){e.moveNodes(r)},removeNodes(e,r){e.removeNodes(r)},setNodes(e,r,t){e.setNodes(r,t)},splitNodes(e,r){e.splitNodes(r)},unsetNodes(e,r,t){e.unsetNodes(r,t)},unwrapNodes(e,r){e.unwrapNodes(r)},wrapNodes(e,r,t){e.wrapNodes(r,t)}},bt={collapse(e,r){e.collapse(r)},deselect(e){e.deselect()},move(e,r){e.move(r)},select(e,r){e.select(r)},setPoint(e,r,t){e.setPoint(r,t)},setSelection(e,r){e.setSelection(r)}},Or=(e,r)=>{for(var t in e){var n=e[t],s=r[t];if(w(n)&&w(s)){if(!Or(n,s))return!1}else if(Array.isArray(n)&&Array.isArray(s)){if(n.length!==s.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==s[i])return!1}else if(n!==s)return!1}for(var a in r)if(e[a]===void 0&&r[a]!==void 0)return!1;return!0};function wt(e,r){if(e==null)return{};var t={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(r.indexOf(s)>=0)&&(t[s]=e[s]);return t}function ae(e,r){if(e==null)return{};var t=wt(e,r),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var Ot=["anchor","focus"];function rr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function Pt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?rr(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var g={edges(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:t=!1}=r,{anchor:n,focus:s}=e;return g.isBackward(e)===t?[n,s]:[s,n]},end(e){var[,r]=g.edges(e);return r},equals(e,r){return m.equals(e.anchor,r.anchor)&&m.equals(e.focus,r.focus)},includes(e,r){if(g.isRange(r)){if(g.includes(e,r.anchor)||g.includes(e,r.focus))return!0;var[t,n]=g.edges(e),[s,i]=g.edges(r);return m.isBefore(t,s)&&m.isAfter(n,i)}var[a,f]=g.edges(e),c=!1,l=!1;return m.isPoint(r)?(c=m.compare(r,a)>=0,l=m.compare(r,f)<=0):(c=o.compare(r,a.path)>=0,l=o.compare(r,f.path)<=0),c&&l},intersection(e,r){var t=ae(e,Ot),[n,s]=g.edges(e),[i,a]=g.edges(r),f=m.isBefore(n,i)?i:n,c=m.isBefore(s,a)?s:a;return m.isBefore(c,f)?null:Pt({anchor:f,focus:c},t)},isBackward(e){var{anchor:r,focus:t}=e;return m.isAfter(r,t)},isCollapsed(e){var{anchor:r,focus:t}=e;return m.equals(r,t)},isExpanded(e){return!g.isCollapsed(e)},isForward(e){return!g.isBackward(e)},isRange(e){return w(e)&&m.isPoint(e.anchor)&&m.isPoint(e.focus)},*points(e){yield[e.anchor,"anchor"],yield[e.focus,"focus"]},start(e){var[r]=g.edges(e);return r},transform(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Te(e,n=>{if(n===null)return null;var{affinity:s="inward"}=t,i,a;if(s==="inward"){var f=g.isCollapsed(n);g.isForward(n)?(i="forward",a=f?i:"backward"):(i="backward",a=f?i:"forward")}else s==="outward"?g.isForward(n)?(i="backward",a="forward"):(i="forward",a="backward"):(i=s,a=s);var c=m.transform(n.anchor,r,{affinity:i}),l=m.transform(n.focus,r,{affinity:a});if(!c||!l)return null;n.anchor=c,n.focus=l})}},tr=e=>w(e)&&u.isNodeList(e.children)&&!A.isEditor(e),M={isAncestor(e){return w(e)&&u.isNodeList(e.children)},isElement:tr,isElementList(e){return Array.isArray(e)&&e.every(r=>M.isElement(r))},isElementProps(e){return e.children!==void 0},isElementType:function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"type";return tr(r)&&r[n]===t},matches(e,r){for(var t in r)if(t!=="children"&&e[t]!==r[t])return!1;return!0}},_t=["children"],xt=["text"],nr=new WeakMap,u={ancestor(e,r){var t=u.get(e,r);if(b.isText(t))throw new Error("Cannot get the ancestor node at path [".concat(r,"] because it refers to a text node instead: ").concat(k.stringify(t)));return t},ancestors(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of o.ancestors(r,t)){var s=u.ancestor(e,n),i=[s,n];yield i}}()},child(e,r){if(b.isText(e))throw new Error("Cannot get the child of a text node: ".concat(k.stringify(e)));var t=e.children[r];if(t==null)throw new Error("Cannot get child at index `".concat(r,"` in node: ").concat(k.stringify(e)));return t},children(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var{reverse:n=!1}=t,s=u.ancestor(e,r),{children:i}=s,a=n?i.length-1:0;n?a>=0:a<i.length;){var f=u.child(s,a),c=r.concat(a);yield[f,c],a=n?a-1:a+1}}()},common(e,r,t){var n=o.common(r,t),s=u.get(e,n);return[s,n]},descendant(e,r){var t=u.get(e,r);if(A.isEditor(t))throw new Error("Cannot get the descendant node at path [".concat(r,"] because it refers to the root editor node instead: ").concat(k.stringify(t)));return t},descendants(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[t,n]of u.nodes(e,r))n.length!==0&&(yield[t,n])}()},elements(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[t,n]of u.nodes(e,r))M.isElement(t)&&(yield[t,n])}()},extractProps(e){if(M.isAncestor(e)){var r=ae(e,_t);return r}else{var r=ae(e,xt);return r}},first(e,r){for(var t=r.slice(),n=u.get(e,t);n&&!(b.isText(n)||n.children.length===0);)n=n.children[0],t.push(0);return[n,t]},fragment(e,r){if(b.isText(e))throw new Error("Cannot get a fragment starting from a root text node: ".concat(k.stringify(e)));var t=Te({children:e.children},n=>{var[s,i]=g.edges(r),a=u.nodes(n,{reverse:!0,pass:p=>{var[,O]=p;return!g.includes(r,O)}});for(var[,f]of a){if(!g.includes(r,f)){var c=u.parent(n,f),l=f[f.length-1];c.children.splice(l,1)}if(o.equals(f,i.path)){var y=u.leaf(n,f);y.text=y.text.slice(0,i.offset)}if(o.equals(f,s.path)){var d=u.leaf(n,f);d.text=d.text.slice(s.offset)}}A.isEditor(n)&&(n.selection=null)});return t.children},get(e,r){for(var t=e,n=0;n<r.length;n++){var s=r[n];if(b.isText(t)||!t.children[s])throw new Error("Cannot find a descendant at path [".concat(r,"] in node: ").concat(k.stringify(e)));t=t.children[s]}return t},has(e,r){for(var t=e,n=0;n<r.length;n++){var s=r[n];if(b.isText(t)||!t.children[s])return!1;t=t.children[s]}return!0},isNode(e){return b.isText(e)||M.isElement(e)||A.isEditor(e)},isNodeList(e){if(!Array.isArray(e))return!1;var r=nr.get(e);if(r!==void 0)return r;var t=e.every(n=>u.isNode(n));return nr.set(e,t),t},last(e,r){for(var t=r.slice(),n=u.get(e,t);n&&!(b.isText(n)||n.children.length===0);){var s=n.children.length-1;n=n.children[s],t.push(s)}return[n,t]},leaf(e,r){var t=u.get(e,r);if(!b.isText(t))throw new Error("Cannot get the leaf node at path [".concat(r,"] because it refers to a non-leaf node: ").concat(k.stringify(t)));return t},levels(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of o.levels(r,t)){var s=u.get(e,n);yield[s,n]}}()},matches(e,r){return M.isElement(e)&&M.isElementProps(r)&&M.matches(e,r)||b.isText(e)&&b.isTextProps(r)&&b.matches(e,r)},nodes(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var{pass:t,reverse:n=!1}=r,{from:s=[],to:i}=r,a=new Set,f=[],c=e;!(i&&(n?o.isBefore(f,i):o.isAfter(f,i)));){if(a.has(c)||(yield[c,f]),!a.has(c)&&!b.isText(c)&&c.children.length!==0&&(t==null||t([c,f])===!1)){a.add(c);var l=n?c.children.length-1:0;o.isAncestor(f,s)&&(l=s[f.length]),f=f.concat(l),c=u.get(e,f);continue}if(f.length===0)break;if(!n){var y=o.next(f);if(u.has(e,y)){f=y,c=u.get(e,f);continue}}if(n&&f[f.length-1]!==0){var d=o.previous(f);f=d,c=u.get(e,f);continue}f=o.parent(f),c=u.get(e,f),a.add(c)}}()},parent(e,r){var t=o.parent(r),n=u.get(e,t);if(b.isText(n))throw new Error("Cannot get the parent of path [".concat(r,"] because it does not exist in the root."));return n},string(e){return b.isText(e)?e.text:e.children.map(u.string).join("")},texts(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[t,n]of u.nodes(e,r))b.isText(t)&&(yield[t,n])}()}};function sr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sr(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var te={isNodeOperation(e){return te.isOperation(e)&&e.type.endsWith("_node")},isOperation(e){if(!w(e))return!1;switch(e.type){case"insert_node":return o.isPath(e.path)&&u.isNode(e.node);case"insert_text":return typeof e.offset=="number"&&typeof e.text=="string"&&o.isPath(e.path);case"merge_node":return typeof e.position=="number"&&o.isPath(e.path)&&w(e.properties);case"move_node":return o.isPath(e.path)&&o.isPath(e.newPath);case"remove_node":return o.isPath(e.path)&&u.isNode(e.node);case"remove_text":return typeof e.offset=="number"&&typeof e.text=="string"&&o.isPath(e.path);case"set_node":return o.isPath(e.path)&&w(e.properties)&&w(e.newProperties);case"set_selection":return e.properties===null&&g.isRange(e.newProperties)||e.newProperties===null&&g.isRange(e.properties)||w(e.properties)&&w(e.newProperties);case"split_node":return o.isPath(e.path)&&typeof e.position=="number"&&w(e.properties);default:return!1}},isOperationList(e){return Array.isArray(e)&&e.every(r=>te.isOperation(r))},isSelectionOperation(e){return te.isOperation(e)&&e.type.endsWith("_selection")},isTextOperation(e){return te.isOperation(e)&&e.type.endsWith("_text")},inverse(e){switch(e.type){case"insert_node":return v(v({},e),{},{type:"remove_node"});case"insert_text":return v(v({},e),{},{type:"remove_text"});case"merge_node":return v(v({},e),{},{type:"split_node",path:o.previous(e.path)});case"move_node":{var{newPath:r,path:t}=e;if(o.equals(r,t))return e;if(o.isSibling(t,r))return v(v({},e),{},{path:r,newPath:t});var n=o.transform(t,e),s=o.transform(o.next(t),e);return v(v({},e),{},{path:n,newPath:s})}case"remove_node":return v(v({},e),{},{type:"insert_node"});case"remove_text":return v(v({},e),{},{type:"insert_text"});case"set_node":{var{properties:i,newProperties:a}=e;return v(v({},e),{},{properties:a,newProperties:i})}case"set_selection":{var{properties:f,newProperties:c}=e;return f==null?v(v({},e),{},{properties:c,newProperties:null}):c==null?v(v({},e),{},{properties:null,newProperties:f}):v(v({},e),{},{properties:c,newProperties:f})}case"split_node":return v(v({},e),{},{type:"merge_node",path:o.next(e.path)})}}},ir=new WeakMap,Et=e=>{var r=ir.get(e);if(r!==void 0)return r;if(!w(e))return!1;var t=typeof e.addMark=="function"&&typeof e.apply=="function"&&typeof e.deleteFragment=="function"&&typeof e.insertBreak=="function"&&typeof e.insertSoftBreak=="function"&&typeof e.insertFragment=="function"&&typeof e.insertNode=="function"&&typeof e.insertText=="function"&&typeof e.isElementReadOnly=="function"&&typeof e.isInline=="function"&&typeof e.isSelectable=="function"&&typeof e.isVoid=="function"&&typeof e.normalizeNode=="function"&&typeof e.onChange=="function"&&typeof e.removeMark=="function"&&typeof e.getDirtyPaths=="function"&&(e.marks===null||w(e.marks))&&(e.selection===null||g.isRange(e.selection))&&u.isNodeList(e.children)&&te.isOperationList(e.operations);return ir.set(e,t),t},A={above(e,r){return e.above(r)},addMark(e,r,t){e.addMark(r,t)},after(e,r,t){return e.after(r,t)},before(e,r,t){return e.before(r,t)},deleteBackward(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:t="character"}=r;e.deleteBackward(t)},deleteForward(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:t="character"}=r;e.deleteForward(t)},deleteFragment(e,r){e.deleteFragment(r)},edges(e,r){return e.edges(r)},elementReadOnly(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.elementReadOnly(r)},end(e,r){return e.end(r)},first(e,r){return e.first(r)},fragment(e,r){return e.fragment(r)},hasBlocks(e,r){return e.hasBlocks(r)},hasInlines(e,r){return e.hasInlines(r)},hasPath(e,r){return e.hasPath(r)},hasTexts(e,r){return e.hasTexts(r)},insertBreak(e){e.insertBreak()},insertFragment(e,r,t){e.insertFragment(r,t)},insertNode(e,r){e.insertNode(r)},insertSoftBreak(e){e.insertSoftBreak()},insertText(e,r){e.insertText(r)},isBlock(e,r){return e.isBlock(r)},isEdge(e,r,t){return e.isEdge(r,t)},isEditor(e){return Et(e)},isElementReadOnly(e,r){return e.isElementReadOnly(r)},isEmpty(e,r){return e.isEmpty(r)},isEnd(e,r,t){return e.isEnd(r,t)},isInline(e,r){return e.isInline(r)},isNormalizing(e){return e.isNormalizing()},isSelectable(e,r){return e.isSelectable(r)},isStart(e,r,t){return e.isStart(r,t)},isVoid(e,r){return e.isVoid(r)},last(e,r){return e.last(r)},leaf(e,r,t){return e.leaf(r,t)},levels(e,r){return e.levels(r)},marks(e){return e.getMarks()},next(e,r){return e.next(r)},node(e,r,t){return e.node(r,t)},nodes(e,r){return e.nodes(r)},normalize(e,r){e.normalize(r)},parent(e,r,t){return e.parent(r,t)},path(e,r,t){return e.path(r,t)},pathRef(e,r,t){return e.pathRef(r,t)},pathRefs(e){return e.pathRefs()},point(e,r,t){return e.point(r,t)},pointRef(e,r,t){return e.pointRef(r,t)},pointRefs(e){return e.pointRefs()},positions(e,r){return e.positions(r)},previous(e,r){return e.previous(r)},range(e,r,t){return e.range(r,t)},rangeRef(e,r,t){return e.rangeRef(r,t)},rangeRefs(e){return e.rangeRefs()},removeMark(e,r){e.removeMark(r)},setNormalizing(e,r){e.setNormalizing(r)},start(e,r){return e.start(r)},string(e,r,t){return e.string(r,t)},unhangRange(e,r,t){return e.unhangRange(r,t)},void(e,r){return e.void(r)},withoutNormalizing(e,r){e.withoutNormalizing(r)},shouldMergeNodesRemovePrevNode:(e,r,t)=>e.shouldMergeNodesRemovePrevNode(r,t)};function ar(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function or(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ar(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ar(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var m={compare(e,r){var t=o.compare(e.path,r.path);return t===0?e.offset<r.offset?-1:e.offset>r.offset?1:0:t},isAfter(e,r){return m.compare(e,r)===1},isBefore(e,r){return m.compare(e,r)===-1},equals(e,r){return e.offset===r.offset&&o.equals(e.path,r.path)},isPoint(e){return w(e)&&typeof e.offset=="number"&&o.isPath(e.path)},transform(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Te(e,n=>{if(n===null)return null;var{affinity:s="forward"}=t,{path:i,offset:a}=n;switch(r.type){case"insert_node":case"move_node":{n.path=o.transform(i,r,t);break}case"insert_text":{o.equals(r.path,i)&&(r.offset<a||r.offset===a&&s==="forward")&&(n.offset+=r.text.length);break}case"merge_node":{o.equals(r.path,i)&&(n.offset+=r.position),n.path=o.transform(i,r,t);break}case"remove_text":{o.equals(r.path,i)&&r.offset<=a&&(n.offset-=Math.min(a-r.offset,r.text.length));break}case"remove_node":{if(o.equals(r.path,i)||o.isAncestor(r.path,i))return null;n.path=o.transform(i,r,t);break}case"split_node":{if(o.equals(r.path,i)){if(r.position===a&&s==null)return null;(r.position<a||r.position===a&&s==="forward")&&(n.offset-=r.position,n.path=o.transform(i,r,or(or({},t),{},{affinity:"forward"})))}else n.path=o.transform(i,r,t);break}}})}},fr=void 0,k={setScrubber(e){fr=e},stringify(e){return JSON.stringify(e,fr)}},At=["text"],jt=["anchor","focus"];function cr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function R(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cr(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var b={equals(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},{loose:n=!1}=t;function s(i){var a=ae(i,At);return a}return Or(n?s(e):e,n?s(r):r)},isText(e){return w(e)&&typeof e.text=="string"},isTextList(e){return Array.isArray(e)&&e.every(r=>b.isText(r))},isTextProps(e){return e.text!==void 0},matches(e,r){for(var t in r)if(t!=="text"&&(!e.hasOwnProperty(t)||e[t]!==r[t]))return!1;return!0},decorations(e,r){var t=[R({},e)];for(var n of r){var s=ae(n,jt),[i,a]=g.edges(n),f=[],c=0,l=i.offset,y=a.offset;for(var d of t){var{length:p}=d.text,O=c;if(c+=p,l<=O&&c<=y){Object.assign(d,s),f.push(d);continue}if(l!==y&&(l===c||y===O)||l>c||y<O||y===O&&O!==0){f.push(d);continue}var P=d,G=void 0,X=void 0;if(y<c){var N=y-O;X=R(R({},P),{},{text:P.text.slice(N)}),P=R(R({},P),{},{text:P.text.slice(0,N)})}if(l>O){var D=l-O;G=R(R({},P),{},{text:P.text.slice(0,D)}),P=R(R({},P),{},{text:P.text.slice(D)})}Object.assign(P,s),G&&f.push(G),f.push(P),X&&f.push(X)}t=f}return t}},St=e=>e.selection?e.selection:e.children.length>0?A.end(e,[]):[0],h;(function(e){e[e.None=0]="None",e[e.Extend=1]="Extend",e[e.ZWJ=2]="ZWJ",e[e.RI=4]="RI",e[e.Prepend=8]="Prepend",e[e.SpacingMark=16]="SpacingMark",e[e.L=32]="L",e[e.V=64]="V",e[e.T=128]="T",e[e.LV=256]="LV",e[e.LVT=512]="LVT",e[e.ExtPict=1024]="ExtPict",e[e.Any=2048]="Any"})(h||(h={}));h.L,h.L|h.V|h.LV|h.LVT,h.LV|h.V,h.V|h.T,h.LVT|h.T,h.T,h.Any,h.Extend|h.ZWJ,h.Any,h.SpacingMark,h.Prepend,h.Any,h.ZWJ,h.ExtPict,h.RI,h.RI;var kt={delete(e,r){e.delete(r)},insertFragment(e,r,t){e.insertFragment(r,t)},insertText(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};A.withoutNormalizing(e,()=>{var{voids:n=!1}=t,{at:s=St(e)}=t;if(o.isPath(s)&&(s=A.range(e,s)),g.isRange(s))if(g.isCollapsed(s))s=s.anchor;else{var i=g.end(s);if(!n&&A.void(e,{at:i}))return;var a=g.start(s),f=A.pointRef(e,a),c=A.pointRef(e,i);lr.delete(e,{at:s,voids:n});var l=f.unref(),y=c.unref();s=l||y,lr.setSelection(e,{anchor:s,focus:s})}if(!(!n&&A.void(e,{at:s})||A.elementReadOnly(e,{at:s}))){var{path:d,offset:p}=s;r.length>0&&e.apply({type:"insert_text",path:d,offset:p,text:r})}})}};function ur(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function ce(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ur(Object(t),!0).forEach(function(n){H(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ur(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var lr=ce(ce(ce(ce({},yt),pt),bt),kt);const _=nt({}),W=e=>e.annotations.filter(r=>{if(e.avFileUuid&&r.file!==e.avFileUuid)return!1;if(e.sets.length>0){const t=e.sets.length===0;if(r.set&&!t&&!e.sets.includes(r.set))return!1}if(e.tags.length>0){let t=!1;for(let n=0;n<r.tags.length;n++){const s=r.tags[n];if(e.tags.find(i=>i.category.toLowerCase()===s.category.toLowerCase()&&i.tag.toLowerCase()===s.tag.toLowerCase())){t=!0;break}}if(!t)return!1}if(e.clip){const t=r.start_time>=e.clip.start&&r.start_time<=e.clip.end,n=r.end_time>=e.clip.start&&r.end_time<=e.clip.end;if(!t&&!n)return!1}if(e.searchQuery){const t=r.annotation.map(n=>u.string(n)).join(`
`).toLowerCase();if(t&&!t.toLowerCase().includes(e.searchQuery.toLowerCase()))return!1}return!0}).map(r=>r.uuid),Pr=(e,r)=>r.tags.length===0?!1:e.tags.length===0&&r.tags.length>0?!0:r.snapToAnnotations,Nt=(e,r)=>{const t=_.get()[r],n=t.tags||[],s=n?.find(a=>a.category===e.category&&a.tag===e.tag)?n.filter(a=>a.category!==e.category||a.tag!==e.tag):[...n,e],i={...t,tags:s};i.filteredAnnotations=W(i),i.snapToAnnotations=Pr(t,i),_.setKey(r,i)},Rt=(e,r,t)=>{const n=_.get()[t],s=n.tags?.filter(a=>a.category.toLowerCase()===e.toLowerCase())||[];let i;if(s.length===r[e].tags.length)i={...n,tags:n.tags?.filter(a=>a.category.toLowerCase()!==e.toLowerCase())};else{const a=r[e].tags.map(c=>({category:e,tag:c})),f=n.tags?[...n.tags]:[];a.forEach(c=>{f.findIndex(l=>l.category.toLowerCase()===c.category.toLowerCase()&&l.tag.toLowerCase()===c.tag.toLowerCase())===-1&&f.push(c)}),i={...n,tags:f}}i.filteredAnnotations=W(i),i.snapToAnnotations=Pr(n,i),_.setKey(t,i)},Dt=(e,r)=>{const t=_.get()[r];let n;t.sets.includes(e)?n={...t,sets:t.sets.filter(s=>s!==e)}:n={...t,sets:[...t.sets,e]},n.filteredAnnotations=W(n),_.setKey(r,n)},Ft=(e,r)=>{const n={..._.get()[r],avFileUuid:e};n.filteredAnnotations=W(n),_.setKey(r,n)},Tt=(e,r)=>{const n={..._.get()[r],searchQuery:e};n.filteredAnnotations=W(n),_.setKey(r,n)},Ct=(e,r)=>{const n={..._.get()[r],[e]:[]};n.filteredAnnotations=W(n),e==="tags"&&(n.snapToAnnotations=!1),_.setKey(r,n)},zt=(e,r)=>{const n={..._.get()[r],clip:e};n.filteredAnnotations=W(n),_.setKey(r,n)};export{_ as $,Tt as a,Rt as b,Ct as c,Nt as d,zt as e,Ft as s,Dt as t};
